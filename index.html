<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Job Hunt Tracker</title>
    <meta name="description" content="Personal Job Hunt Tracker - Track every opportunity, interaction & milestone">

    <!-- TailwindCSS v4 via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="bg-gray-900 text-gray-100 min-h-screen">
    <!-- Auth Screen (shown when not logged in) -->
    <div id="authScreen" class="hidden">
        <!-- Dynamically populated by auth.js -->
    </div>

    <!-- Main App Container (shown when logged in) -->
    <div id="appContainer" class="hidden">
        <!-- Header -->
        <header
            class="bg-gradient-to-r from-indigo-900 via-purple-900 to-indigo-900 shadow-xl border-b border-indigo-700">
            <div class="max-w-7xl mx-auto px-4 py-6">
                <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                    <div>
                        <h1 class="text-2xl sm:text-3xl font-bold text-white flex items-center gap-3">
                            <i class="fas fa-briefcase text-indigo-400"></i>
                            My Job Hunt Tracker
                        </h1>
                        <p class="text-indigo-300 mt-1 text-sm sm:text-base">Track every opportunity, interaction &
                            milestone</p>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="window.app.openAddModal()"
                            class="bg-indigo-600 hover:bg-indigo-500 text-white px-4 sm:px-6 py-2 sm:py-3 rounded-xl font-semibold flex items-center gap-2 transition shadow-lg text-sm sm:text-base">
                            <i class="fas fa-plus"></i> New Opportunity
                        </button>
                        <!-- User Display -->
                        <div id="userDisplay"
                            class="hidden sm:flex items-center gap-2 bg-gray-800/50 border border-gray-700 rounded-xl px-3 py-2">
                            <i class="fas fa-user-circle text-indigo-400"></i>
                            <span id="userDisplayName" class="text-gray-300 text-sm font-medium"></span>
                        </div>
                        <button onclick="window.app.openSettingsModal()" title="Settings"
                            class="bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white p-2 sm:p-3 rounded-xl transition">
                            <i class="fas fa-cog"></i>
                        </button>
                        <button onclick="window.app.logout()" title="Sign Out"
                            class="bg-gray-700 hover:bg-gray-600 text-gray-300 hover:text-white p-2 sm:p-3 rounded-xl transition">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Follow-up Nudge Banner -->
        <div id="followUpBanner" class="hidden max-w-7xl mx-auto px-4 pt-4">
            <div id="followUpBannerContent" class="bg-amber-900/40 border border-amber-600/50 rounded-xl p-4">
                <!-- Dynamically populated by UIController -->
            </div>
        </div>

        <!-- Stats Dashboard -->
        <div class="max-w-7xl mx-auto px-4 py-6">
            <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-7 gap-2 sm:gap-3" id="stageCounts">
                <!-- Dynamically populated -->
            </div>
        </div>

        <!-- Data Insights Section -->
        <main class="max-w-7xl mx-auto px-4 pb-8">
            <!-- View Switcher & Filters Bar -->
            <div class="bg-gray-800 rounded-xl border border-gray-700 p-4 mb-6">
                <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4">
                    <!-- View Toggle -->
                    <div class="flex items-center gap-2">
                        <span class="text-gray-400 text-sm font-medium mr-2">View:</span>
                        <div class="flex bg-gray-900 rounded-lg p-1">
                            <button onclick="window.app.switchView('card')"
                                class="view-btn active px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2"
                                data-view="card">
                                <i class="fas fa-th-large"></i> <span class="hidden sm:inline">Cards</span>
                            </button>
                            <button onclick="window.app.switchView('table')"
                                class="view-btn px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 text-gray-400 hover:text-white"
                                data-view="table">
                                <i class="fas fa-table"></i> <span class="hidden sm:inline">Table</span>
                            </button>
                            <button onclick="window.app.switchView('kanban')"
                                class="view-btn px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 text-gray-400 hover:text-white"
                                data-view="kanban">
                                <i class="fas fa-columns"></i> <span class="hidden sm:inline">Kanban</span>
                            </button>
                            <button onclick="window.app.switchView('analytics')"
                                class="view-btn px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 text-gray-400 hover:text-white"
                                data-view="analytics">
                                <i class="fas fa-chart-pie"></i> <span class="hidden sm:inline">Analytics</span>
                            </button>
                            <button onclick="window.app.switchView('calendar')"
                                class="view-btn px-3 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 text-gray-400 hover:text-white"
                                data-view="calendar">
                                <i class="fas fa-calendar-alt"></i> <span class="hidden sm:inline">Calendar</span>
                            </button>
                        </div>
                    </div>

                    <!-- Adaptive Filters -->
                    <div class="flex flex-wrap items-center gap-2 w-full lg:w-auto">
                        <!-- Search -->
                        <div class="relative flex-1 lg:flex-none">
                            <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-500"></i>
                            <input type="text" id="searchInput" placeholder="Search company, role..."
                                class="bg-gray-700 border border-gray-600 rounded-lg pl-10 pr-4 py-2 text-sm text-white w-full lg:w-48 focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                        </div>

                        <!-- Stage Filter -->
                        <div class="relative">
                            <button onclick="window.app.toggleFilterDropdown('stageFilter')"
                                class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white flex items-center gap-2 hover:bg-gray-600">
                                <i class="fas fa-filter text-indigo-400"></i> Stage
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <div id="stageFilter"
                                class="filter-dropdown hidden absolute top-full mt-1 left-0 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-20 min-w-[180px]">
                                <div class="p-2">
                                    <label class="flex items-center gap-2 p-2 hover:bg-gray-700 rounded cursor-pointer">
                                        <input type="checkbox" class="stage-filter-cb rounded" value="all" checked
                                            onchange="window.app.applyFilters()">
                                        <span class="text-sm">All Stages</span>
                                    </label>
                                    <div id="stageFilterOptions"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Type Filter -->
                        <div class="relative">
                            <button onclick="window.app.toggleFilterDropdown('typeFilter')"
                                class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white flex items-center gap-2 hover:bg-gray-600">
                                <i class="fas fa-briefcase text-green-400"></i> Type
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <div id="typeFilter"
                                class="filter-dropdown hidden absolute top-full mt-1 left-0 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-20 min-w-[180px]">
                                <div class="p-2" id="typeFilterOptions"></div>
                            </div>
                        </div>

                        <!-- Location Filter -->
                        <div class="relative">
                            <button onclick="window.app.toggleFilterDropdown('locationFilter')"
                                class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white flex items-center gap-2 hover:bg-gray-600">
                                <i class="fas fa-map-marker-alt text-red-400"></i> Location
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <div id="locationFilter"
                                class="filter-dropdown hidden absolute top-full mt-1 left-0 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-20 min-w-[180px]">
                                <div class="p-2" id="locationFilterOptions"></div>
                            </div>
                        </div>

                        <!-- Result Filter -->
                        <div class="relative">
                            <button onclick="window.app.toggleFilterDropdown('resultFilter')"
                                class="bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white flex items-center gap-2 hover:bg-gray-600">
                                <i class="fas fa-flag text-yellow-400"></i> Result
                                <i class="fas fa-chevron-down text-xs"></i>
                            </button>
                            <div id="resultFilter"
                                class="filter-dropdown hidden absolute top-full mt-1 right-0 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-20 min-w-[180px]">
                                <div class="p-2" id="resultFilterOptions"></div>
                            </div>
                        </div>

                        <!-- Clear Filters -->
                        <button onclick="window.app.clearFilters()"
                            class="bg-red-600/20 border border-red-600/30 text-red-400 rounded-lg px-3 py-2 text-sm hover:bg-red-600/30 transition">
                            <i class="fas fa-times"></i> Clear
                        </button>
                    </div>
                </div>

                <!-- Active Filters Display -->
                <div id="activeFiltersBar" class="hidden mt-3 pt-3 border-t border-gray-700">
                    <div class="flex flex-wrap items-center gap-2">
                        <span class="text-gray-500 text-sm">Active Filters:</span>
                        <div id="activeFilterTags" class="flex flex-wrap gap-2"></div>
                    </div>
                </div>
            </div>

            <!-- Table Column Selector (shown only in table view) -->
            <div id="columnSelector" class="hidden bg-gray-800 rounded-xl border border-gray-700 p-4 mb-4">
                <div class="flex flex-wrap items-center gap-3">
                    <span class="text-gray-400 text-sm font-medium">Show Columns:</span>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="company" checked
                            onchange="window.app.updateTableColumns()"> Company
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="role" checked
                            onchange="window.app.updateTableColumns()"> Role
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="hr" checked
                            onchange="window.app.updateTableColumns()"> HR/Vendor
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="type" checked
                            onchange="window.app.updateTableColumns()"> Type
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="location" checked
                            onchange="window.app.updateTableColumns()"> Location
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="salary" checked
                            onchange="window.app.updateTableColumns()"> Salary
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="stage" checked
                            onchange="window.app.updateTableColumns()"> Stage
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="result"
                            onchange="window.app.updateTableColumns()"> Result
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="lastAction" checked
                            onchange="window.app.updateTableColumns()"> Last Action
                    </label>
                    <label class="flex items-center gap-1 text-sm text-gray-300 cursor-pointer">
                        <input type="checkbox" class="col-toggle rounded" data-col="updated" checked
                            onchange="window.app.updateTableColumns()"> Updated
                    </label>
                </div>
            </div>

            <!-- Card View -->
            <div id="cardView" class="view-container">
                <div id="applicationsGrid" class="grid gap-4 sm:grid-cols-2 lg:grid-cols-3">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- Table View -->
            <div id="tableView" class="view-container hidden">
                <div id="tableBulkActions" class="mb-3 hidden">
                    <!-- Dynamically populated -->
                </div>
                <div
                    class="table-container bg-gray-800 rounded-xl border border-gray-700 overflow-y-auto max-h-[calc(100vh-280px)]">
                    <table class="w-full text-sm relative">
                        <thead id="tableHead" class="bg-gray-900 text-gray-400 text-left sticky top-0 z-20 shadow-sm">
                            <!-- Dynamically populated -->
                        </thead>
                        <tbody id="tableBody" class="divide-y divide-gray-700">
                            <!-- Dynamically populated -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Kanban View -->
            <div id="kanbanView" class="view-container hidden">
                <div class="kanban-wrapper flex gap-4 overflow-x-auto pb-4" id="kanbanBoard">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- Analytics View -->
            <div id="analyticsView" class="view-container hidden">
                <!-- Dynamically populated -->
            </div>

            <!-- Calendar View -->
            <div id="calendarView" class="view-container hidden">
                <!-- Dynamically populated -->
            </div>

            <!-- Upcoming Interviews Widget (shown on card/table views) -->
            <div id="upcomingInterviewsWidget" class="mt-6 hidden">
                <!-- Dynamically populated -->
            </div>

            <!-- Empty State -->
            <div id="emptyState" class="hidden text-center py-16">
                <i class="fas fa-folder-open text-6xl text-gray-600 mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-400">No applications found</h3>
                <p class="text-gray-500 mt-2">Try adjusting your filters or add a new opportunity</p>
            </div>

            <!-- Results Summary -->
            <div id="resultsSummary" class="mt-4 text-center text-gray-500 text-sm">
                <!-- Dynamically populated -->
            </div>
        </main>

        <!-- Add/Edit Modal -->
        <div id="addModal"
            class="modal fixed inset-0 bg-black/70 z-50 hidden items-center justify-center p-4 overflow-y-auto">
            <div class="bg-gray-800 rounded-2xl max-w-2xl w-full my-8 shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 id="modalTitle" class="text-xl font-bold text-white">Add New Opportunity</h2>
                        <button onclick="window.app.closeAddModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <form id="applicationForm" class="p-6 space-y-6 max-h-[70vh] overflow-y-auto">
                    <input type="hidden" id="appId">

                    <!-- SECTION 1: Company & Role -->
                    <div class="space-y-4">
                        <h3
                            class="text-sm font-semibold text-indigo-400 uppercase tracking-wider flex items-center gap-2">
                            <i class="fas fa-building"></i> Company & Role
                        </h3>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Company Name *</label>
                                <input type="text" id="companyName" required
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Role/Position *</label>
                                <input type="text" id="role" required
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                            </div>
                        </div>
                    </div>

                    <!-- SECTION 2: Contact Source -->
                    <div class="space-y-4 border-t border-gray-700 pt-4">
                        <h3
                            class="text-sm font-semibold text-indigo-400 uppercase tracking-wider flex items-center gap-2">
                            <i class="fas fa-user-tie"></i> Contact Source
                        </h3>

                        <!-- Vendor Toggle -->
                        <div class="flex items-center gap-4">
                            <label class="text-sm text-gray-300">Contact from:</label>
                            <div class="flex bg-gray-700 rounded-lg p-1">
                                <button type="button" id="btnDirectHR"
                                    class="contact-source-btn active px-4 py-2 rounded-md text-sm font-medium transition"
                                    onclick="window.app.toggleContactSource(false)">
                                    <i class="fas fa-building mr-1"></i> Direct HR
                                </button>
                                <button type="button" id="btnViaVendor"
                                    class="contact-source-btn px-4 py-2 rounded-md text-sm font-medium text-gray-400 transition"
                                    onclick="window.app.toggleContactSource(true)">
                                    <i class="fas fa-handshake mr-1"></i> Via Vendor
                                </button>
                            </div>
                            <input type="hidden" id="isVendor" value="false">
                        </div>

                        <!-- Vendor Company Name (shown only when Via Vendor) -->
                        <div id="vendorField" class="hidden">
                            <label class="block text-sm font-medium text-gray-300 mb-1">Vendor Company Name</label>
                            <input type="text" id="vendorCompanyName"
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                placeholder="e.g., ABC Consultants">
                        </div>

                        <!-- Contact Person Name -->
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1" id="contactPersonLabel">HR
                                Name</label>
                            <input type="text" id="contactPersonName"
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                placeholder="Contact person name">
                        </div>

                        <!-- Phone & Email -->
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Contact Phone</label>
                                <input type="tel" id="contactPhone"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="+91 98765 43210">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Contact Email</label>
                                <input type="email" id="contactEmail"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="hr@company.com">
                            </div>
                        </div>
                    </div>

                    <!-- SECTION 3: Opportunity Details -->
                    <div class="space-y-4 border-t border-gray-700 pt-4">
                        <h3
                            class="text-sm font-semibold text-indigo-400 uppercase tracking-wider flex items-center gap-2">
                            <i class="fas fa-briefcase"></i> Opportunity Details
                        </h3>
                        <div class="grid md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Opportunity Type</label>
                                <select id="opportunityType"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                                    <option value="">Select...</option>
                                    <option value="C2H">C2H (Contract to Hire)</option>
                                    <option value="Company Payroll">Company Payroll</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Location</label>
                                <select id="location"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                                    <option value="">Select...</option>
                                    <option value="Remote">Remote</option>
                                    <option value="WFO">Work From Office</option>
                                    <option value="Hybrid">Hybrid</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">City</label>
                                <input type="text" id="city"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="e.g., Mumbai">
                            </div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Expected Salary (‚Çπ)</label>
                                <input type="number" id="expectedSalary"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="e.g., 2500000">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-300 mb-1">Notice Period</label>
                                <input type="text" id="noticePeriod"
                                    class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                    placeholder="e.g., 30 days, Immediate">
                            </div>
                        </div>
                    </div>

                    <!-- SECTION 4: Skills (Tag Input) -->
                    <div class="space-y-4 border-t border-gray-700 pt-4">
                        <h3
                            class="text-sm font-semibold text-indigo-400 uppercase tracking-wider flex items-center gap-2">
                            <i class="fas fa-code"></i> Key Skills Required
                        </h3>
                        <div class="relative">
                            <!-- Selected Tags Container -->
                            <div id="skillTagsContainer"
                                class="flex flex-wrap gap-2 p-3 bg-gray-700 border border-gray-600 rounded-lg min-h-[48px]">
                                <!-- Tags will be inserted here dynamically -->
                                <input type="text" id="skillInput"
                                    class="flex-1 min-w-[150px] bg-transparent border-none outline-none text-white placeholder-gray-400"
                                    placeholder="Type skill and press Enter...">
                            </div>
                            <!-- Hidden field to store skills as JSON -->
                            <input type="hidden" id="skillTagsData" value="[]">
                            <!-- Autocomplete Suggestions -->
                            <div id="skillSuggestions"
                                class="hidden absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-10 max-h-48 overflow-y-auto">
                                <!-- Suggestions populated dynamically -->
                            </div>
                        </div>
                        <p class="text-xs text-gray-500">Press Enter or comma to add a skill. Click √ó to remove.</p>
                    </div>

                    <!-- SECTION 5: Job Description -->
                    <div class="space-y-4 border-t border-gray-700 pt-4">
                        <h3
                            class="text-sm font-semibold text-indigo-400 uppercase tracking-wider flex items-center gap-2">
                            <i class="fas fa-file-alt"></i> Job Description
                        </h3>
                        <div>
                            <textarea id="jobDescription" rows="4"
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                                placeholder="Paste job description here..."></textarea>
                        </div>
                    </div>

                    <!-- Stage (no finalResult ‚Äî that's set by close flow) -->
                    <div class="space-y-4 border-t border-gray-700 pt-4">
                        <h3
                            class="text-sm font-semibold text-indigo-400 uppercase tracking-wider flex items-center gap-2">
                            <i class="fas fa-tasks"></i> Status
                        </h3>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Current Stage</label>
                            <select id="currentStage"
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                                <option value="1">Opportunity Received</option>
                                <option value="2">Under Discussion</option>
                                <option value="3">Screening</option>
                                <option value="4">Shortlisted</option>
                                <option value="5">Interviewing</option>
                                <option value="6">Offer Stage</option>
                                <option value="0">Closed</option>
                            </select>
                        </div>
                    </div>

                    <!-- Submit Buttons -->
                    <div class="flex gap-3 pt-4 border-t border-gray-700">
                        <button type="submit"
                            class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-semibold transition">
                            <i class="fas fa-save mr-2"></i> Save Application
                        </button>
                        <button type="button" onclick="window.app.closeAddModal()"
                            class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Detail View Modal -->
        <div id="detailModal" class="modal fixed inset-0 bg-black/70 z-50 hidden overflow-y-auto">
            <div class="min-h-screen flex items-start justify-end">
                <div id="detailPanel"
                    class="slide-in bg-gray-800 w-full max-w-2xl min-h-screen shadow-2xl border-l border-gray-700">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Add Interaction Modal -->
        <div id="interactionModal"
            class="modal fixed inset-0 bg-black/70 z-[60] hidden items-center justify-center p-4">
            <div class="bg-gray-800 rounded-2xl max-w-lg w-full shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold text-white">Log Interaction</h2>
                        <button onclick="window.app.closeInteractionModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <form id="interactionForm" class="p-6 space-y-4">
                    <input type="hidden" id="interactionAppId">

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Interaction Type</label>
                        <select id="interactionType" required
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                            <option value="hr_called">üìû HR/Vendor Called Me</option>
                            <option value="followed_up">üì± I Followed Up</option>
                            <option value="document_received">üìß Document Received</option>
                            <option value="interview_round">üé§ Interview Round</option>
                            <option value="note">üìù Note</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Date & Time</label>
                        <input type="datetime-local" id="interactionDate" required
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Summary / Notes *</label>
                        <textarea id="interactionNotes" rows="4" required
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"
                            placeholder="What was discussed? Any action items?"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Update Stage?</label>
                        <select id="interactionStage"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                            <option value="">No change</option>
                            <option value="1">Opportunity Received</option>
                            <option value="2">Under Discussion</option>
                            <option value="3">Screening</option>
                            <option value="4">Shortlisted</option>
                            <option value="5">Interviewing</option>
                            <option value="6">Offer Stage</option>
                            <option value="0">Closed</option>
                        </select>
                    </div>

                    <div class="flex gap-3 pt-4">
                        <button type="submit"
                            class="flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-xl font-semibold transition">
                            <i class="fas fa-plus mr-2"></i> Log Interaction
                        </button>
                        <button type="button" onclick="window.app.closeInteractionModal()"
                            class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Interview Schedule Modal -->
        <div id="interviewScheduleModal"
            class="modal fixed inset-0 bg-black/70 z-[60] hidden items-center justify-center p-4 overflow-y-auto">
            <div class="bg-gray-800 rounded-2xl max-w-lg w-full my-8 shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 id="interviewModalTitle" class="text-xl font-bold text-white">Schedule Interview</h2>
                        <button onclick="window.app.closeScheduleInterviewModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <form id="interviewScheduleForm" class="p-6 space-y-4 max-h-[70vh] overflow-y-auto">
                    <input type="hidden" id="interviewId">

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Application *</label>
                        <select id="interviewAppSelect" required
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                            <option value="">Select application...</option>
                            <!-- Dynamically populated -->
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Round Number</label>
                        <input type="number" id="interviewRoundNumber" min="1" readonly
                            class="w-full bg-gray-600 border border-gray-500 rounded-lg px-4 py-2 text-white cursor-not-allowed"
                            value="1">
                        <p class="text-xs text-gray-500 mt-1">Auto-assigned based on previous rounds</p>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Interview Type *</label>
                            <select id="interviewType" required
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                                <!-- Dynamically populated from settings -->
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Mode *</label>
                            <select id="interviewMode" required
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                                <!-- Dynamically populated from settings -->
                            </select>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Date & Time *</label>
                            <input type="datetime-local" id="interviewDateTime" required
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-300 mb-1">Duration (mins)</label>
                            <select id="interviewDuration"
                                class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                                <option value="30">30 minutes</option>
                                <option value="45">45 minutes</option>
                                <option value="60" selected>60 minutes</option>
                                <option value="90">90 minutes</option>
                                <option value="120">120 minutes</option>
                            </select>
                        </div>
                    </div>

                    <div id="meetingLinkField">
                        <label class="block text-sm font-medium text-gray-300 mb-1">Meeting Link</label>
                        <input type="url" id="interviewMeetingLink" placeholder="https://meet.google.com/..."
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                    </div>

                    <div id="locationField" class="hidden">
                        <label class="block text-sm font-medium text-gray-300 mb-1">Location</label>
                        <input type="text" id="interviewLocation" placeholder="Office address..."
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Interviewer Name</label>
                        <input type="text" id="interviewerName" placeholder="John Doe"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Reminder</label>
                        <select id="interviewReminder"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500">
                            <option value="15">15 minutes before</option>
                            <option value="30" selected>30 minutes before</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Notes / Preparation</label>
                        <textarea id="interviewNotes" rows="3" placeholder="Topics to prepare, questions to ask..."
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white focus:ring-2 focus:ring-indigo-500"></textarea>
                    </div>

                    <div class="flex gap-3 pt-4">
                        <button type="submit"
                            class="flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-xl font-semibold transition">
                            <i class="fas fa-calendar-check mr-2"></i> Schedule Interview
                        </button>
                        <button type="button" onclick="window.app.closeScheduleInterviewModal()"
                            class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Interview Detail Panel (slide-in) -->
        <div id="interviewDetailModal" class="modal fixed inset-0 bg-black/70 z-50 hidden overflow-y-auto">
            <div class="min-h-screen flex items-start justify-end">
                <div id="interviewDetailPanel"
                    class="slide-in bg-gray-800 w-full max-w-lg min-h-screen shadow-2xl border-l border-gray-700">
                    <!-- Dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Close Application Modal -->
        <div id="closeAppModal" class="modal fixed inset-0 bg-black/70 z-[60] hidden items-center justify-center p-4">
            <div class="bg-gray-800 rounded-2xl max-w-md w-full shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold text-white">Close Application</h2>
                        <button onclick="window.app.closeCloseAppModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <form id="closeAppForm" class="p-6 space-y-4">
                    <input type="hidden" id="closeAppId">
                    <p id="closeAppInfo" class="text-gray-300 text-sm"></p>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Reason *</label>
                        <select id="closeAppReason" required
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                            <option value="rejected">‚ùå Rejected by Company</option>
                            <option value="declined">üö´ Declined by Me</option>
                            <option value="ghosted">üëª Ghosted / No Response</option>
                            <option value="withdrawn">üö™ Withdrawn from Process</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Notes (optional)</label>
                        <textarea id="closeAppNotes" rows="3"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"
                            placeholder="Any additional context..."></textarea>
                    </div>
                    <div class="flex gap-3 pt-2">
                        <button type="submit"
                            class="flex-1 bg-red-600 hover:bg-red-500 text-white py-3 rounded-xl font-semibold transition">
                            <i class="fas fa-times-circle mr-2"></i> Close Application
                        </button>
                        <button type="button" onclick="window.app.closeCloseAppModal()"
                            class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Round Outcome Modal -->
        <div id="roundOutcomeModal"
            class="modal fixed inset-0 bg-black/70 z-[60] hidden items-center justify-center p-4">
            <div class="bg-gray-800 rounded-2xl max-w-md w-full shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold text-white">Round Outcome</h2>
                        <button onclick="window.app.closeRoundOutcomeModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <input type="hidden" id="roundOutcomeInterviewId">
                    <p id="roundOutcomeInfo" class="text-gray-300 text-sm"></p>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">What was the outcome?</label>
                        <textarea id="roundOutcomeNotes" rows="2"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white mb-3"
                            placeholder="Brief notes about how it went..."></textarea>
                        <div class="flex gap-3">
                            <button type="button" onclick="window.app.submitRoundOutcome('cleared')"
                                class="flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-xl font-semibold transition">
                                ‚úÖ Cleared
                            </button>
                            <button type="button" onclick="window.app.submitRoundOutcome('not_cleared')"
                                class="flex-1 bg-red-600 hover:bg-red-500 text-white py-3 rounded-xl font-semibold transition">
                                ‚ùå Not Cleared
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Result Modal (Offer Stage) -->
        <div id="resultModal" class="modal fixed inset-0 bg-black/70 z-[60] hidden items-center justify-center p-4">
            <div class="bg-gray-800 rounded-2xl max-w-md w-full shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold text-white">Offer Received! üéâ</h2>
                        <button onclick="window.app.closeResultModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <div class="p-6 space-y-4">
                    <input type="hidden" id="resultAppId">
                    <p class="text-gray-300 text-sm">Congratulations on reaching the Offer stage! What is the final
                        outcome?</p>

                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-2">Outcome</label>
                        <div class="flex gap-3 mb-4">
                            <button type="button" onclick="window.app.submitResult('accepted')"
                                class="flex-1 bg-green-600 hover:bg-green-500 text-white py-3 rounded-xl font-semibold transition flex flex-col items-center justify-center gap-1">
                                <i class="fas fa-check-circle text-xl"></i>
                                <span>Accepted</span>
                            </button>
                            <button type="button" onclick="window.app.submitResult('declined')"
                                class="flex-1 bg-gray-700 hover:bg-gray-600 text-white py-3 rounded-xl font-semibold transition flex flex-col items-center justify-center gap-1">
                                <i class="fas fa-ban text-xl"></i>
                                <span>Declined</span>
                            </button>
                        </div>

                        <label class="block text-sm font-medium text-gray-300 mb-1">Notes (optional)</label>
                        <textarea id="resultNotes" rows="2"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white"
                            placeholder="Salary offered, joining date, etc..."></textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal fixed inset-0 bg-black/70 z-[60] hidden items-center justify-center p-4">
            <div class="bg-gray-800 rounded-2xl max-w-md w-full shadow-2xl border border-gray-700">
                <div class="p-6 border-b border-gray-700">
                    <div class="flex justify-between items-center">
                        <h2 class="text-xl font-bold text-white"><i class="fas fa-cog mr-2 text-indigo-400"></i>Settings
                        </h2>
                        <button onclick="window.app.closeSettingsModal()"
                            class="text-gray-400 hover:text-white text-2xl">&times;</button>
                    </div>
                </div>
                <div class="p-6 space-y-5">
                    <h3 class="text-sm font-semibold text-gray-400 uppercase tracking-wider">Follow-up Timers</h3>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Initial Wait (days)</label>
                        <p class="text-xs text-gray-500 mb-2">Days to wait before first follow-up reminder</p>
                        <input type="number" id="settingInitialWaitDays" min="1" max="30" value="3"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Subsequent Wait (days)</label>
                        <p class="text-xs text-gray-500 mb-2">Days between follow-up reminders after the first</p>
                        <input type="number" id="settingSubsequentWaitDays" min="1" max="30" value="5"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-300 mb-1">Max Follow-up Attempts</label>
                        <p class="text-xs text-gray-500 mb-2">After this many attempts, the app is flagged as possible
                            ghosting</p>
                        <input type="number" id="settingMaxAttempts" min="1" max="10" value="3"
                            class="w-full bg-gray-700 border border-gray-600 rounded-lg px-4 py-2 text-white">
                    </div>
                    <div class="flex gap-3 pt-2">
                        <button type="button" onclick="window.app.saveSettings()"
                            class="flex-1 bg-indigo-600 hover:bg-indigo-500 text-white py-3 rounded-xl font-semibold transition">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                        <button type="button" onclick="window.app.closeSettingsModal()"
                            class="px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-semibold transition">
                            Cancel
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- End appContainer -->

    <!-- Vite Entry Point -->
    <script type="module" src="/src/main.js"></script>
</body>

</html>